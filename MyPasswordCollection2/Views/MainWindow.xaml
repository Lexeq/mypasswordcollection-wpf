<Window x:Class="MPC.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MPC"
        mc:Ignorable="d"
        Title="MyPasswordCollection"
        Height="350"
        Width="525"
        MinHeight="200" 
        MinWidth="250">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisible"/>
    </Window.Resources>
    
    <Window.InputBindings>
        <KeyBinding Modifiers="Ctrl"
                    Key="O"
                    Command="{Binding OpenFileCommand}"/>

        <KeyBinding Modifiers="Ctrl"
                    Key="N"
                    Command="{Binding NewPasswordCollectionCommand}"/>
    </Window.InputBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*" />
            <ColumnDefinition Width="3*" />
        </Grid.ColumnDefinitions>

        <Menu Grid.ColumnSpan="2"
              Padding="2.5"
              Name="mainMenu"
              HorizontalAlignment="Stretch"
              Width="auto"
              Height="auto"
              IsMainMenu="True">
            
            <Menu.Background>
                <LinearGradientBrush StartPoint="0.3,0"
                                     EndPoint="1,0">
                    <GradientStop Color="#FFE0E8FF" 
                                  Offset="0"/>
                    <GradientStop Color="#00E0E8FF"
                                  Offset="1"/>
                </LinearGradientBrush>
            </Menu.Background>
            
            <MenuItem Header="_File">
                <MenuItem Header="_New..."
                          Command="{Binding NewPasswordCollectionCommand}"
                          InputGestureText="Ctrl + N"/>
                
                <MenuItem Header="_Open..."
                          Command="{Binding OpenFileCommand}"
                          InputGestureText="Ctrl + O"/>
                <MenuItem Header="_Close"
                          Command="{Binding CloseFileCommand}"/>
                <MenuItem Header="_Exit"/>
            </MenuItem>
            
            <MenuItem Header="_Edit">
                <MenuItem Header="Change master password..."
                          Command="{Binding ChangePasswordCommand}"/>
                
                <MenuItem Header="Clear collection"
                          Command="{Binding ClearCommand}"/>
                
                <MenuItem Header="Delete file"
                          Command="{Binding DeleteCollectionCommand}"/>
            </MenuItem>
            
            <MenuItem Header="_Help" >
                <MenuItem Header="_About..."
                          Command="{Binding ShowAboutCommand}"/>
            </MenuItem>
        </Menu>

        <Grid Grid.Row="1" Name="gridPasswordCollection">
            <Grid.RowDefinitions>
                <RowDefinition Height="auto"/>
                <RowDefinition/>
                <RowDefinition Height="auto"/>
            </Grid.RowDefinitions>

            <Border Grid.Row="0"
                    Padding="5">
                <Grid Name="grSearch">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBox Grid.Column="0"
                             Margin="2,2,5,2"
                             Width="auto"
                             HorizontalAlignment="Stretch"
                             VerticalContentAlignment="Center" 
                             Text="{Binding Path=SearchString, UpdateSourceTrigger=PropertyChanged}"/>

                    <Button  Grid.Column="1"
                             Margin="2"
                             Padding="5,2,5,2"
                             MaxWidth="70"
                             MinWidth="30"
                             Width="auto"
                             Command="{Binding FindCommand}"
                             Content="Find"/>
                </Grid>
            </Border>

            <ListBox ItemsSource="{Binding PasswordSource.Passwords}"
                     DisplayMemberPath="Site"
                     SelectedItem="{Binding SelectedItem}"
                     Margin="7" Name="lbPasswords" Grid.Row="1">

            </ListBox>

            <Grid Grid.Row="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>

                <Button Command="{Binding AddCommand}"
                        Padding="2"
                        Grid.Column="0"
                        Margin="10"
                        Name="btnAdd"
                        Content="Add"/>
                <Button Command="{Binding RemoveCommand}"
                        CommandParameter="{Binding SelectedItem}"
                        Padding="2"
                        Grid.Column="1" 
                        Margin="10"
                        Name="btnRemove"
                        Content="Remove"/>

            </Grid>


        </Grid>

        <local:PasswordView Grid.Row="1" 
                            Grid.Column="1"/>
    </Grid>
</Window>